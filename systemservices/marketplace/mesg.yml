name: Marketplace
sid: marketplace
description: ""
configuration:
  env:
    - PROVIDER_ENDPOINT=https://ropsten.infura.io/v3/6115ae2531f64c04a9a392cf500e5fbe
    - BLOCK_CONFIRMATIONS=0
    - DEFAULT_GAS=1000000
    - POLLING_TIME=1000
    - MARKETPLACE_ADDRESS=0x94F4cB92Fe9f547574Aec617B1594B13aBd47Ad3
    - TOKEN_ADDRESS=0x5861b3dc52339d4f976b7fa5d80db6cd6f477f1b
tasks:
  listServices:
    inputs:
    outputs:
      success:
        data:
          services: &services
            type: Object
            repeated: true
            object: &service
              sid: &sid
                type: String
              createTime: &createTime
                type: String
              owner: &owner
                type: String
              versions: &versions
                type: Object
                repeated: true
                optional: true
                object: &version
                  versionHash: &versionHash
                    type: String
                  manifest: &manifest
                    type: String
                  manifestProtocol: &manifestProtocol
                    type: String
                  manifestData: &manifestData
                    type: Object
                    optional: true
                    object: 	
                      version: 	
                        type: String	
                      service: &manifestServiceData	
                        type: Object	
                        object:	
                          hash:	
                            type: String	
                          hashVersion: 	
                            type: String	
                          deployment:	
                            type: Object	
                            object:	
                              type: 	
                                type: String	
                              source: 	
                                type: String	
                          definition: 	
                            type: Object	
                          readme: 	
                            type: String	
                            optional: true
                  createTime: *createTime
              offers: &offers
                type: Object
                repeated: true
                optional: true
                object: &offer
                  offerIndex: &offerIndex
                    type: String
                  price: &price
                    type: String
                  duration: &duration
                    type: String
                  active:
                    type: Boolean
                  createTime: *createTime
              purchases: &purchases
                type: Object
                repeated: true
                optional: true
                object: &purchase
                  purchaser: &purchaser
                    type: String
                  expire: &expire
                    type: String
                  createTime: *createTime
      error: &outputError
        name: "Error"
        description: "Output when an error occurs"
        data:
          message:
            name: "Message"
            description: "The error message"
            type: String
          code:
            name: "Error code"
            description: "The error code"
            type: String
            optional: true
  getService:
    inputs:
      sid: *sid
    outputs:
      success:
        data: *service
      error: *outputError
  preparePublishServiceVersion:
    inputs:
      service:
        type: Object
        object:
          hash:
            type: String
          hashVersion: 
            type: String
          deployment:
            type: Object
            object:
              type: 
                type: String
              source: 
                type: String
          definition: 
            type: Object
          readme: 
            type: String
            optional: true
      from: &inputFrom
        type: String
      gas: &inputGas
        type: Number
        optional: true
      gasPrice: &inputGasPrice
        type: String
        optional: true
    outputs:
      error: *outputError
      success: &outputTransaction
        data: &transaction
          chainID:
            name: "Chain ID"
            description: "The ID of the chain the transaction is for. See https://github.com/ethereum/EIPs/blob/master/EIPS/eip-155.md#list-of-chain-ids."
            type: Number
          nonce:
            name: "Nonce"
            description: "Nonce to use."
            type: Number
          to:
            name: "To"
            description: "The to address."
            type: String
          value:
            name: "Value"
            description: "The value in Wei."
            type: String
          gas:
            name: "Gas"
            description: "The maximum gas to use to execute this transaction"
            type: Number
          gasPrice:
            name: "Gas price"
            description: "The gas price in Wei."
            type: String
          data:
            name: "Data"
            description: "The data of the transaction."
            type: String
  publishPublishServiceVersion:
    inputs:
      signedTransaction: &signedTransaction
        type: String
    outputs:
      error: *outputError
      success:
        data:
          sid: *sid
          versionHash: *versionHash
          manifest: *manifest
          manifestProtocol: *manifestProtocol
  prepareCreateServiceOffer:
    inputs:
      sid: *sid
      price: *price
      duration: *duration
      from: *inputFrom
      gas: *inputGas
      gasPrice: *inputGasPrice
    outputs:
      error: *outputError
      success: *outputTransaction
  publishCreateServiceOffer:
    inputs:
      signedTransaction: *signedTransaction
    outputs:
      error: *outputError
      success:
        data:
          sid: *sid
          offerIndex: *offerIndex
          price: *price
          duration: *duration
  preparePurchase:
    inputs:
      sid: *sid
      offerIndex: *offerIndex
      from: *inputFrom
      gas: *inputGas
      gasPrice: *inputGasPrice
    outputs:
      error: *outputError
      success:
        data:
          transactions:
            repeated: true
            type: Object
            object: *transaction
  publishPurchase:
    inputs:
      signedTransactions:
        <<: *signedTransaction
        repeated: true
    outputs:
      error: *outputError
      success:
        data:
          sid: *sid
          offerIndex: *offerIndex
          purchaser: *purchaser
          price: *price
          duration: *duration
          expire: *expire
  isAuthorized:
    inputs:
      sid:
        <<: *sid
        optional: true
      versionHash:
        <<: *versionHash
        optional: true
      addresses:
        repeated: true
        type: String
    outputs:
      error: *outputError
      success:
        data:
          authorized:
            type: Boolean
          sid: *sid
          source:
            type: String
            optional: true
          type:
            type: String
            optional: true
events:
  serviceCreated:
    data:
      sid: *sid
      owner: *owner
  serviceOwnershipTransferred:
    data:
      sid: *sid
      previousOwner:
        type: String
      newOwner:
        type: String
  serviceVersionCreated:
    data:
      sid: *sid
      versionHash: *versionHash
      manifest: *manifest
      manifestProtocol: *manifestProtocol
  serviceOfferCreated:
    data:
      sid: *sid
      offerIndex: *offerIndex
      price: *price
      duration: *duration
  serviceOfferDisabled:
    data:
      sid: *sid
      offerIndex: *offerIndex
  servicePurchased:
    data:
      sid: *sid
      offerIndex: *offerIndex
      purchaser: *purchaser
      price: *price
      duration: *duration
      expire: *expire
