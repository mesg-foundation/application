syntax = "proto3";

import "protobuf/definition/instance.proto";

package api;

// This is the API to interact with the Instances.
//
// This API is a [gRPC](https://grpc.io/) API.
//
// The source file of this API is hosted on [GitHub](https://github.com/mesg-foundation/engine/blob/master/protobuf/api/instance.proto).
service Instance {

  // Get returns an Instance matching the criteria of the request.
  rpc Get (GetInstanceRequest) returns (GetInstanceResponse) {}

  // List returns all Instances matching the criteria of the request.
  rpc List (ListInstancesRequest) returns (ListInstancesResponse) {}

  // Create an Instance from a Service's hash and custom environmental variables.
  // It will return an unique identifier which is used to interact with the Instance.
  rpc Create (CreateInstanceRequest) returns (CreateInstanceResponse) {}

  // Delete an Instance.
  rpc Delete (DeleteInstanceRequest) returns (DeleteInstanceResponse) {}
}

// The request's data for the `Get` API.
//
// **Example**	
// TODO: add JSON example
message GetInstanceRequest {
  string hash = 1;
}

message GetInstanceResponse {
  definition.Instance instance = 1;
}

// The request's data for the `List` API.
//
// **Example**	
// TODO: add JSON example
message ListInstancesRequest {
  string serviceHash = 1;   // Filter by Services' hash.
}

// The response's data for the `List` API.
//
// **Example**	
// TODO: add JSON example
message ListInstancesResponse {
  repeated definition.Instance instances = 1; // List of instances that match the request's filters.
}

// The request's data for the `Create` API.
//
// **Example**	
// TODO: add JSON example
message CreateInstanceRequest {
  string serviceHash = 1;   // Service's hash.
  repeated string env = 2;  // Environmental variables to apply to the Instance.
}

// The response's data for the `Create` API.
//
// **Example**	
// TODO: add JSON example
message CreateInstanceResponse {
  definition.Instance instance = 1;
}

// The request's data for the `Delete` API.
//
// **Example**	
// TODO: add JSON example
message DeleteInstanceRequest {
  string hash = 1;      // Instance's hash
  bool deleteData = 2;  // If true, any persistent data (volumes) that belongs to the instance and its dependencies will also be deleted.
}

// The response's data for the `Delete` API.
//
// **Example**	
// TODO: add JSON example
message DeleteInstanceResponse {
  string hash = 1;  // Instance's hash deleted.
}
